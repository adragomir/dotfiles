#!/bin/bash

if [ "A$3" == "A" ]
then
  echo "Syntax: $0 pomfile jarfile dir"
  return
fi

rm -rvf "$3/src"
mkdir -p "$3/src/main/java"
cp -f "$1" "$3/pom.xml"
for name in $(jar -tf "$2" | sed -n -e "/\\$/d;s/\\.class/.java/p")
do 
  echo -n "Looking for $name ... "
  loc="$(find . | fgrep $name | head -n 1)"
  if [ "A$loc" == "A" ]
  then 
    echo "NOT FOUND"
  else 
    echo "$loc"
    mkdir -p "$3/src/main/java/$(dirname $name)"
    cp "$loc" "$3/src/main/java/$name"
  fi
done

