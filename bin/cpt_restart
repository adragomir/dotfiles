#!/bin/bash

username=adragomi
password=$(security find-generic-password -a adragomi -s adragomi-adobe -w)

hostname=$1

token=$(curl -s --location --request POST 'https://cpt-selfservice-api.corp.ethos10-prod-va7.ethos.adobe.net/api/token-auth' --header 'Content-Type: application/json' --data-raw "{ \"username\" : \"$username\", \"password\": \"$password\"}"  | jq ".token" -r )

curl -s --location --request POST 'https://cpt-selfservice-api.corp.ethos10-prod-va7.ethos.adobe.net/api/device_operations' --header 'Content-Type: application/json' --header "Authorization: Token $token" --data-raw "{\"spec\": {\"name\": \"$hostname\"}, \"operation\": \"Reset\"}"
